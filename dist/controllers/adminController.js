const reservation=require("../models/reservation");exports.admin=async(e,s)=>{try{e.session.admin?"accepted"==e.query.show?reservation.find({Accepted:!0,Rejected:!1},(e,r)=>{s.render("pages/admin",{reservations:r,show:"accepted"})}):"rejected"==e.query.show?reservation.find({Rejected:!0},(e,r)=>{s.render("pages/admin",{reservations:r,show:"rejected"})}):reservation.find({Accepted:!1,Rejected:!1},(e,r)=>{s.render("pages/admin",{reservations:r,show:"waiting"})}):s.redirect("/signin")}catch(e){s.status(500).send({message:e.message||"Error Occured"})}},exports.accepted=async(e,r)=>{try{e.session.admin?r.redirect("/admin?show=accepted"):r.redirect("/signin")}catch(e){r.status(500).send({message:e.message||"Error Occured"})}},exports.rejected=async(e,r)=>{try{e.session.admin?r.redirect("/admin?show=rejected"):r.redirect("/signin")}catch(e){r.status(500).send({message:e.message||"Error Occured"})}},exports.updateReservation=async(e,r)=>{try{var s,t;e.session.admin?({action:s,id:t}=e.body,"Akceptuj"===s?reservation.updateOne({_id:t},{$set:{Accepted:!0}},()=>{r.redirect("/admin")}):"Odrzuć"==s?reservation.updateOne({_id:t},{$set:{Rejected:!0}},()=>{r.redirect("/admin")}):"Anuluj Rezerwację"==s?reservation.updateOne({_id:t},{$set:{Accepted:!1}},()=>{r.redirect("/admin?show=accepted")}):"Przywróć"==s?reservation.updateOne({_id:t},{$set:{Accepted:!1,Rejected:!1}},()=>{r.redirect("/admin?show=rejected")}):"Usuń"==s?reservation.deleteOne({_id:t},()=>{r.redirect("/admin?show=rejected")}):r.redirect("/admin")):r.redirect("/signin")}catch(e){r.status(500).send({message:e.message||"Error Occured"})}},exports.logout=async(e,r)=>{try{e.session=null,r.redirect("/")}catch(e){r.status(500).send({message:e.message||"Error Occured"})}};